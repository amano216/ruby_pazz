<!DOCTYPE html>
<html>
<head>
  <title>Ruby Interpreter Test</title>
</head>
<body>
  <h1>Ruby Interpreter Test</h1>
  <div id="results"></div>
  
  <script src="puzzles.js"></script>
  <script src="app.js"></script>
  <script>
    const interpreter = new RubyInterpreter();
    const results = document.getElementById('results');
    
    const tests = [
      {
        name: "問題12: 文字列の式展開",
        code: 'name = "Ruby"\nputs "My name is #{name}"',
        expected: "My name is Ruby\n"
      },
      {
        name: "問題14: to_i * 2",
        code: 'str = "50"\nputs str.to_i*2',
        expected: "100\n"
      },
      {
        name: "問題16: 配列の要素取得",
        code: 'array = [10, 20, 30]\nputs array[1]',
        expected: "20\n"
      },
      {
        name: "問題17: 配列に追加",
        code: 'array = [1, 2]\narray << 3\nputs array',
        expected: "[1, 2, 3]\n"
      },
      {
        name: "Print vs Puts",
        code: 'print "Hello"\nputs " World"',
        expected: "Hello World\n"
      },
      {
        name: "P (inspect)",
        code: 'p "Hello"',
        expected: '"Hello"\n'
      },
      {
        name: "Times iteration",
        code: '3.times { puts "Hi" }',
        expected: "Hi\nHi\nHi\n"
      },
      {
        name: "Each iteration",
        code: '[1, 2, 3].each { |n| puts n }',
        expected: "1\n2\n3\n"
      },
      {
        name: "String upcase",
        code: 'puts "hello".upcase',
        expected: "HELLO\n"
      },
      {
        name: "Array join",
        code: 'puts [1, 2, 3].join(", ")',
        expected: "1, 2, 3\n"
      }
    ];
    
    tests.forEach(test => {
      try {
        interpreter.reset();
        const result = interpreter.execute(test.code);
        const passed = result === test.expected;
        
        results.innerHTML += `
          <div style="margin: 20px; padding: 10px; border: 1px solid ${passed ? 'green' : 'red'}">
            <h3>${test.name}: ${passed ? '✅ PASSED' : '❌ FAILED'}</h3>
            <pre>Code: ${test.code}</pre>
            <pre>Expected: ${JSON.stringify(test.expected)}</pre>
            <pre>Got: ${JSON.stringify(result)}</pre>
          </div>
        `;
      } catch (error) {
        results.innerHTML += `
          <div style="margin: 20px; padding: 10px; border: 1px solid red">
            <h3>${test.name}: ❌ ERROR</h3>
            <pre>Code: ${test.code}</pre>
            <pre>Error: ${error.message}</pre>
          </div>
        `;
      }
    });
  </script>
</body>
</html>